---
title: "NFC Port Softwareのインストールが環境変数の設定で失敗する場合の対処法"
date: "2022-12-28"
---

NFCPortWithDriver.exeを実行し、NFC Port Software のインストールを試みたところ、「環境変数の設定に失敗しました。」というエラーで失敗したので、対処法をメモしておきます。

結論としては、システム環境変数の `Path` に少し空きを作ってあげればよいです。具体的には次の2つの操作をお試しください。

- システム環境変数の `Path` に登録されている不要な環境変数を削除する
- システム環境変数の `Path` に登録されている環境変数の一部をユーザー環境変数の `Path` に移動させる

**※ なお、環境変数の操作を行うとコンピュータが正常に動作しなくなる恐れがあります。作業は自己責任で、慎重に行うようお願いいたします。**

より高度な環境変数の操作は次の記事が詳しいです。

[上野家のホームページ - 資料室 : PC/Windows/Windowsの環境変数のサイズやPATHの長さ制限についてWindowsの環境変数のサイズやPATHの長さ制限について](https://yueno.net/xoops/modules/xpwiki/?PC%2FWindows%2FWindows%E3%81%AE%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA%E3%82%84PATH%E3%81%AE%E9%95%B7%E3%81%95%E5%88%B6%E9%99%90%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6)

## 環境

- Windows 10 Pro 22H2(OSビルド: 19045.2364)
- NFCPortWithDriver.exe(製品バージョン: 6.2.1.1)

## 問題

NFCPortWithDriver.exeを実行しましたが、インストール途中で「環境変数の設定に失敗しました。」というエラーが出て終了してしまいました。

Windowsは環境変数の文字数に2000文字制限があり、筆者の環境を調べると約2500文字使用されていました。

[国島 丈生 on Twitter: "NFCポートソフトウェアをインストールしようとしたら「環境変数の設定に失敗しました」とか言われてインストールできないんだけど...なんなんすかこれ。 / Twitter"](https://twitter.com/kunishi/status/933323489393512448)

この状態で他のアプリケーションは登録できていたはずなので、なぜNFCPortWithDriver.exeだけが環境変数の影響を受けたのかは不明です。

## 方法

環境変数の操作により不具合が生じた場合に元に戻せるよう、バックアップをおすすめします。次のようなバックアップ方法が考えられます。

- 「システムの保護」で「復元ポイントの作成」をする
- 環境変数をメモ帳などにコピペする
- 環境変数の操作画面をスクショする

バックアップができたら、システム環境変数の `Path` に登録されている環境変数を少し減らしましょう。環境変数の操作については他に分かりやすい記事が多くあるため省略します。適宜「windows10 環境変数」などで検索してください。

筆者の場合、システム環境変数の `Path` を約100文字削除したところ、インストールに成功しました。

NFC Port Software のインストールに成功したら、カードリーダー機器をPCに接続し、自己診断ツールで動作確認をしましょう。自己診断ツールは、スタートボタン > NFCポート 内にあります。自己診断ツールを起動したらガイダンスに沿って進め、最後に機器名に「○」が表示されればOKです。

## まとめ

NFC Port Software のインストールが「環境変数の設定に失敗しました。」というエラーで失敗した場合は、システム環境変数の `Path` に少し空きを作ってあげると解決することがあります。

## 参考

- [国島 丈生 on Twitter: "NFCポートソフトウェアをインストールしようとしたら「環境変数の設定に失敗しました」とか言われてインストールできないんだけど...なんなんすかこれ。 / Twitter"](https://twitter.com/kunishi/status/933323489393512448)

- [上野家のホームページ - 資料室 : PC/Windows/Windowsの環境変数のサイズやPATHの長さ制限についてWindowsの環境変数のサイズやPATHの長さ制限について](https://yueno.net/xoops/modules/xpwiki/?PC%2FWindows%2FWindows%E3%81%AE%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA%E3%82%84PATH%E3%81%AE%E9%95%B7%E3%81%95%E5%88%B6%E9%99%90%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6)
